(()=>{var e={};e.id=5168,e.ids=[5168],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},11185:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=r(50482),a=r(69108),n=r(62563),i=r.n(n),o=r(68300),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["(main)",{children:["attendance",{children:["roster",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,99554)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/attendance/roster/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,84308)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/attendance/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,22758)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,12962)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/attendance/roster/page.tsx"],x="/(main)/attendance/roster/page",p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(main)/attendance/roster/page",pathname:"/attendance/roster",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},95118:(e,t,r)=>{Promise.resolve().then(r.bind(r,94772))},94772:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(95344),a=r(43989),n=r(3729),i=r(18117),o=r(1660),l=r(71532),d=r(97751),c=r(1960),x=r(25545),p=r(31498),u=r(65489),m=r(22927),h=r(57887);let g=e=>{let t=e.toLowerCase();return t.includes("morning")||t.includes("general")?"bg-blue-100 text-blue-800 border-blue-200":t.includes("evening")||t.includes("afternoon")?"bg-orange-100 text-orange-800 border-orange-200":t.includes("night")?"bg-indigo-100 text-indigo-800 border-indigo-200":"bg-gray-100 text-gray-800 border-gray-200"};function f(){let e=(0,a.p)(),[t,r]=(0,n.useState)([]),[f,y]=(0,n.useState)([]),[b,v]=(0,n.useState)({}),[j,w]=(0,n.useState)([]),[N,D]=(0,n.useState)(!0),[S,k]=(0,n.useState)(!1),[q,_]=(0,n.useState)(new Date),{can:P,user:Z}=(0,u.g)();if(Z&&!P("ShiftRoster","read"))return s.jsx(h.Z,{});(0,n.useEffect)(()=>{z()},[]),(0,n.useEffect)(()=>{$()},[q]);let z=async()=>{try{D(!0);let[e,t]=await Promise.all([i.Z.get("/employees"),i.Z.get("/shifts")]);r(e.data),y(t.data)}catch(e){console.error("Failed to load initial data:",e)}finally{D(!1)}},$=async()=>{try{let e=I(q),t=new Date(e);t.setDate(t.getDate()+6);let r=await i.Z.get("/shift-rosters",{params:{startDate:e.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0]}}),s=await o.Nt.getAll(q.getFullYear());w(s);let a={};r.data.forEach(e=>{let t=e.date.split("T")[0],r=`${e.employeeId}-${t}`;e.isLeave?a[r]={type:"leave",name:e.shift.name,shiftId:"LEAVE",leaveType:e.shift.name.replace("Leave: ","")}:a[r]={type:"shift",shiftId:e.shiftId}}),v(a)}catch(e){console.error("Failed to load roster:",e)}},I=e=>{let t=new Date(e),r=t.getDay(),s=t.getDate()-r+(0===r?-6:1);return new Date(t.setDate(s))},C=(e,t,r)=>{let s=t.toISOString().split("T")[0];v(t=>({...t,[`${e}-${s}`]:{type:"shift",shiftId:r}}))},R=async()=>{try{k(!0);let t=Object.entries(b).filter(([e,t])=>"shift"===t.type).map(([e,t])=>{let r=e.slice(-10);return{employeeId:e.slice(0,-11),date:r,shiftId:t.shiftId}});await i.Z.post("/shift-rosters/batch",{assignments:t}),e.success("Roster saved successfully")}catch(r){console.error("Failed to save roster:",r);let t=r.response?.data?.error||"Failed to save roster";e.error(t)}finally{k(!1)}},A=(()=>{let e=I(q);return Array.from({length:7},(t,r)=>{let s=new Date(e);return s.setDate(s.getDate()+r),s})})();return N?(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[s.jsx("div",{className:"h-8 bg-gray-200 animate-pulse w-48 rounded"}),s.jsx("div",{className:"grid grid-cols-8 gap-2",children:Array.from({length:64}).map((e,t)=>s.jsx("div",{className:"h-12 bg-gray-100 animate-pulse rounded"},t))})]}):(0,s.jsxs)("div",{className:"p-6 h-[calc(100vh-64px)] flex flex-col bg-gray-50/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Shift Roster"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Weekly Shift Planner"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex bg-white rounded-md shadow-sm border border-gray-300",children:[s.jsx("button",{onClick:()=>{let e=new Date(q);e.setDate(e.getDate()-7),_(e)},className:"p-2 hover:bg-gray-50 border-r",children:s.jsx(l.Z,{size:18})}),(0,s.jsxs)("div",{className:"px-4 py-2 text-sm font-medium w-48 text-center text-gray-700",children:[A[0].toLocaleDateString(void 0,{month:"short",day:"numeric"})," - ",A[6].toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})]}),s.jsx("button",{onClick:()=>{let e=new Date(q);e.setDate(e.getDate()+7),_(e)},className:"p-2 hover:bg-gray-50 border-l",children:s.jsx(d.Z,{size:18})})]}),(P("ShiftRoster","create")||P("ShiftRoster","update"))&&(0,s.jsxs)("button",{onClick:()=>{confirm("This will overwrite current week with previous week's shifts. Continue?")&&e.info("Feature coming soon: Copy from previous week template")},className:"flex items-center space-x-2 px-3 py-2 bg-white border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 shadow-sm",children:[s.jsx(c.Z,{size:16}),s.jsx("span",{children:"Copy Previous"})]}),s.jsx(m.n,{module:"ShiftRoster",action:"update",children:(0,s.jsxs)("button",{onClick:R,disabled:S,className:"flex items-center space-x-2 bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 disabled:opacity-50 shadow-sm transition-colors",children:[S?s.jsx(x.Z,{size:18,className:"animate-spin"}):s.jsx(p.Z,{size:18}),s.jsx("span",{children:S?"Saving...":"Save Roster"})]})})]})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 flex-grow overflow-auto relative",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 border-separate border-spacing-0",children:[s.jsx("thead",{className:"bg-gray-50/80 backdrop-blur sticky top-0 z-20",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-4 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-30 border-r border-b w-64 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:"Employee Details"}),A.map(e=>(0,s.jsxs)("th",{className:`px-2 py-3 text-center border-b min-w-[140px] ${[0,6].includes(e.getDay())?"bg-red-50/30":""}`,children:[s.jsx("div",{className:`text-sm font-bold ${[0,6].includes(e.getDay())?"text-red-600":"text-gray-800"}`,children:e.toLocaleDateString("en-US",{weekday:"short"})}),(0,s.jsxs)("div",{className:"text-xs text-gray-400 font-medium",children:[e.getDate()," ",e.toLocaleDateString("en-US",{month:"short"})]})]},e.toISOString()))]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:t.map(e=>(0,s.jsxs)("tr",{className:"group hover:bg-indigo-50/10 transition-colors",children:[s.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-0 bg-white group-hover:bg-indigo-50/10 z-10 border-r border-gray-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.02)]",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 h-9 w-9 rounded-full bg-gradient-to-tr from-indigo-100 to-purple-100 flex items-center justify-center text-indigo-700 font-bold text-xs ring-2 ring-white shadow-sm",children:[e.firstName[0],e.lastName[0]]}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsxs)("div",{className:"text-sm font-bold text-gray-900",children:[e.firstName," ",e.lastName]}),s.jsx("div",{className:"text-xs text-gray-500 font-mono",children:e.employeeId})]})]})}),A.map(t=>{let r=t.toISOString().split("T")[0],a=b[`${e.id}-${r}`],n=j.find(e=>new Date(e.date).toDateString()===t.toDateString()),i=!!n,o=a?.type==="leave",l=a?.type==="shift"?a.shiftId:"",d=a?.leaveType||"Leave",c=f.find(e=>e.id===l),x="bg-white border-gray-200 text-gray-400";return o?x="bg-red-50 border-red-200 text-red-700 font-medium":l&&c?x=g(c.name):i&&(x="bg-teal-50 border-teal-200 text-teal-800 font-medium"),s.jsx("td",{className:"px-2 py-2 text-center border-b border-r border-gray-50 last:border-r-0",children:s.jsx("div",{className:"relative group/cell",children:o?(0,s.jsxs)("div",{className:`w-full py-2 px-2 rounded-lg border text-xs flex items-center justify-center gap-1 ${x}`,children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),d]}):i&&!l?(0,s.jsxs)("div",{className:`w-full py-2 px-2 rounded-lg border text-xs flex items-center justify-center gap-1 ${x}`,children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-teal-500"}),n?.name]}):P("ShiftRoster","create")||P("ShiftRoster","update")?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("select",{value:l,onChange:r=>C(e.id,t,r.target.value),className:`block w-full text-xs rounded-lg border px-2 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 appearance-none cursor-pointer transition-all shadow-sm ${x} font-medium text-center hover:border-indigo-300`,children:[s.jsx("option",{value:"",children:i?`${n?.name} (Holiday)`:"Off (Rest)"}),f.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),!l&&!i&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none text-gray-300 text-[10px] font-bold tracking-wider",children:"OFF"})]}):s.jsx("div",{className:`w-full py-2 px-2 rounded-lg border text-xs flex items-center justify-center ${x} font-medium`,children:c?c.name:i?n?.name:"Off"})})},r)})]},e.id))})]})}),(0,s.jsxs)("div",{className:"mt-4 flex items-center space-x-6 text-xs text-gray-600 border-t pt-4",children:[s.jsx("span",{className:"font-semibold",children:"Legend:"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"w-3 h-3 bg-blue-100 border border-blue-200 rounded"}),s.jsx("span",{children:"General/Morning"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"w-3 h-3 bg-orange-100 border border-orange-200 rounded"}),s.jsx("span",{children:"Evening/Afternoon"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"w-3 h-3 bg-indigo-100 border border-indigo-200 rounded"}),s.jsx("span",{children:"Night Shift"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"w-3 h-3 bg-gray-100 border border-gray-200 rounded"}),s.jsx("span",{children:"Off / Rest Day"})]})]})]})}},57887:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(95344),a=r(20783),n=r.n(a),i=r(61459);function o(){return(0,s.jsxs)("div",{className:"min-h-[60vh] flex flex-col items-center justify-center text-center px-4",children:[s.jsx("div",{className:"bg-red-50 p-4 rounded-full mb-4",children:s.jsx(i.Z,{className:"h-12 w-12 text-red-600"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-gray-600 mb-6 max-w-md",children:"You do not have the necessary permissions to view this page. Please contact your administrator if you believe this is an error."}),s.jsx(n(),{href:"/dashboard",className:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 transition-colors",children:"Return to Dashboard"})]})}},22927:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var s=r(95344);r(3729);var a=r(65489);let n=({module:e,action:t,children:r,fallback:n=null})=>{let{can:i}=(0,a.g)();return i(e,t)?s.jsx(s.Fragment,{children:r}):s.jsx(s.Fragment,{children:n})}},43989:(e,t,r)=>{"use strict";r.d(t,{p:()=>a});var s=r(92373);function a(){let{showToast:e}=(0,s.useToastContext)();return{success:t=>e("success",t),error:t=>e("error",t),warning:t=>e("warning",t),info:t=>e("info",t)}}},25545:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},31498:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},61459:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},99554:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>i});let s=(0,r(86843).createProxy)(String.raw`/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/attendance/roster/page.tsx`),{__esModule:a,$$typeof:n}=s,i=s.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[6291,1934,783,7316,2841,6241],()=>r(11185));module.exports=s})();