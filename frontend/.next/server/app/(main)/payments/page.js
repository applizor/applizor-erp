(()=>{var e={};e.id=1729,e.ids=[1729],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},66993:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var a=s(50482),r=s(69108),n=s(62563),i=s.n(n),o=s(68300),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=["",{children:["(main)",{children:["payments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,68446)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/payments/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,22758)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,12962)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/payments/page.tsx"],u="/(main)/payments/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(main)/payments/page",pathname:"/payments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},27736:(e,t,s)=>{Promise.resolve().then(s.bind(s,14261))},14261:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(95344),r=s(43989),n=s(3729),i=s(22254),o=s(67857),l=s(18117);let c={createPaymentLink:async e=>(await l.Z.post("/payments/link",e)).data,verifyPayment:async e=>(await l.Z.post("/payments/verify",e)).data,getAll:async e=>(await l.Z.get("/payments",{params:e})).data};var d=s(25045);function u(){let e=(0,r.p)(),t=(0,i.useRouter)(),[s,l]=(0,n.useState)([]),[u,p]=(0,n.useState)([]),[m,x]=(0,n.useState)(!0),[y,g]=(0,n.useState)(!1),[h,v]=(0,n.useState)({invoiceId:"",amount:""});(0,n.useEffect)(()=>{if(!o.I.isAuthenticated()){t.push("/login");return}f(),b()},[t]);let f=async()=>{try{x(!0);let e=await c.getAll({limit:50});l(e.payments||[])}catch(e){console.error("Failed to load payments:",e)}finally{x(!1)}},b=async()=>{try{let e=await d.i.getAll({limit:100});p(e.invoices||[])}catch(e){console.error("Failed to load invoices:",e)}},w=async t=>{t.preventDefault();try{let t=await c.createPaymentLink({invoiceId:h.invoiceId,amount:h.amount?parseFloat(h.amount):void 0});t.paymentLink?.short_url&&(window.open(t.paymentLink.short_url,"_blank"),e.success("Payment link created! Opening in new tab..."),g(!1),f())}catch(t){e.error(t.response?.data?.error||"Failed to create payment link")}},j=e=>({pending:"bg-yellow-100 text-yellow-800",success:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800",refunded:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800";return a.jsx("div",{className:"px-4 py-6 sm:px-0",children:(0,a.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Payments"}),a.jsx("button",{onClick:()=>g(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700",children:"+ Create Payment Link"})]}),m?a.jsx("div",{className:"text-center py-8",children:"Loading..."}):0===s.length?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No payments found"}):a.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:a.jsx("ul",{className:"divide-y divide-gray-200",children:s.map(e=>a.jsx("li",{className:"px-6 py-4 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Payment #",e.id.slice(0,8)]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Invoice: ",e.invoiceId?e.invoiceId.slice(0,8):"N/A"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Date: ",new Date(e.paymentDate).toLocaleDateString()]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Method: ",e.paymentMethod," ",e.gateway&&`(${e.gateway})`]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["₹",e.amount.toLocaleString()]}),a.jsx("span",{className:`px-2 py-1 text-xs rounded ${j(e.status)}`,children:e.status})]})]})},e.id))})}),y&&a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Create Payment Link"}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Invoice *"}),(0,a.jsxs)("select",{required:!0,value:h.invoiceId,onChange:e=>v({...h,invoiceId:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select invoice"}),u.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.invoiceNumber," - ₹",e.total," (",e.status,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount (Optional)"}),a.jsx("input",{type:"number",placeholder:"Leave empty for full invoice amount",value:h.amount,onChange:e=>v({...h,amount:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:()=>g(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Cancel"}),a.jsx("button",{type:"submit",className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700",children:"Create Link"})]})]})]})})]})})}},43989:(e,t,s)=>{"use strict";s.d(t,{p:()=>r});var a=s(92373);function r(){let{showToast:e}=(0,a.useToastContext)();return{success:t=>e("success",t),error:t=>e("error",t),warning:t=>e("warning",t),info:t=>e("info",t)}}},25045:(e,t,s)=>{"use strict";s.d(t,{i:()=>r});var a=s(18117);let r={getAll:async e=>(await a.Z.get("/invoices",{params:e})).data,getById:async e=>(await a.Z.get(`/invoices/${e}`)).data,create:async e=>(await a.Z.post("/invoices",e)).data,generatePDF:async(e,t)=>(await a.Z.get(`/invoices/${e}/pdf`,{params:{letterheadMode:t},responseType:"blob"})).data,updateStatus:async(e,t)=>(await a.Z.patch(`/invoices/${e}/status`,{status:t})).data,sendEmail:async e=>(await a.Z.post(`/invoices/${e}/send`)).data}},67857:(e,t,s)=>{"use strict";s.d(t,{I:()=>n,a:()=>i});var a=s(18117),r=s(3729);let n={register:async e=>{let t=await a.Z.post("/auth/register",e);return t.data.token&&(localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user))),t.data},login:async(e,t)=>{let s=await a.Z.post("/auth/login",{email:e,password:t});return s.data.token&&(localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user))),s.data},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},getToken:()=>null,getUser:()=>null,isAuthenticated:()=>!!n.getToken()},i=()=>{let[e,t]=(0,r.useState)(null),[s,i]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{let e=n.getUser();if(e&&t(e),n.getToken())try{let e=await a.Z.get("/auth/profile");if(e.data.user){let s=e.data.user;localStorage.setItem("user",JSON.stringify(s)),t(s)}}catch(e){console.error("Auth refresh failed",e)}i(!1)})()},[]),{user:e,loading:s,isAuthenticated:!!e}}},22254:(e,t,s)=>{e.exports=s(14767)},68446:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>r,default:()=>i});let a=(0,s(86843).createProxy)(String.raw`/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/payments/page.tsx`),{__esModule:r,$$typeof:n}=a,i=a.default}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[6291,1934,3553],()=>s(66993));module.exports=a})();