(()=>{var e={};e.id=7059,e.ids=[7059],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},71105:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(50482),a=r(69108),n=r(62563),i=r.n(n),l=r(68300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["(main)",{children:["quotations",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,27131)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/quotations/create/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,22758)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,12962)),"/Users/arun/Documents/applizor-softech-erp/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/quotations/create/page.tsx"],u="/(main)/quotations/create/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(main)/quotations/create/page",pathname:"/quotations/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},85682:(e,t,r)=>{Promise.resolve().then(r.bind(r,79204))},79204:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(95344),a=r(3729),n=r(22254),i=r(18117),l=r(43989),o=r(65489),d=r(95252),c=r(73050);function u(){let e,t,r;let u=(0,n.useRouter)(),m=(0,l.p)(),{can:p}=(0,o.g)(),{formatCurrency:x}=(0,c.U)(),[h,g]=(0,a.useState)(!1),[b,y]=(0,a.useState)([]);(0,a.useEffect)(()=>{p("Quotation","create")||(m.error("Access denied"),u.push("/quotations"))},[p,u,m]);let[f,v]=(0,a.useState)({leadId:"",title:"",description:"",validUntil:"",paymentTerms:"Payment due within 30 days",deliveryTerms:"",notes:""}),[j,N]=(0,a.useState)([{description:"",quantity:1,unitPrice:0,tax:18,discount:0}]);(0,a.useEffect)(()=>{q()},[]);let q=async()=>{try{let e=await i.Z.get("/leads");y(e.data.leads)}catch(e){console.error("Failed to load leads")}},w=e=>{N(j.filter((t,r)=>r!==e))},k=(e,t,r)=>{let s=[...j];s[e]={...s[e],[t]:r},N(s)},P=async e=>{if(e.preventDefault(),!f.leadId||!f.title||0===j.length){m.error("Please fill all required fields");return}try{g(!0),await i.Z.post("/quotations",{...f,items:j}),m.success("Quotation created successfully"),u.push("/quotations")}catch(e){m.error("Failed to create quotation")}finally{g(!1)}},C=(e=0,t=0,r=0,j.forEach(s=>{let a=s.quantity*s.unitPrice,n=a*s.tax/100,i=a*s.discount/100;e+=a,t+=n,r+=i}),{subtotal:e,tax:t,discount:r,total:e+t-r});return(0,s.jsxs)("div",{className:"p-6 max-w-5xl mx-auto",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Create Quotation"}),(0,s.jsxs)("form",{onSubmit:P,className:"bg-white rounded-lg shadow p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Lead ",s.jsx("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("select",{required:!0,value:f.leadId,onChange:e=>v({...f,leadId:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[s.jsx("option",{value:"",children:"Select Lead"}),b.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," - ",e.company]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Valid Until ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"date",required:!0,value:f.validUntil,onChange:e=>v({...f,validUntil:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",required:!0,value:f.title,onChange:e=>v({...f,title:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"e.g., Website Development Proposal"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:f.description,onChange:e=>v({...f,description:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:3,placeholder:"Brief description of the quotation"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Items"}),s.jsx("button",{type:"button",onClick:()=>{N([...j,{description:"",quantity:1,unitPrice:0,tax:18,discount:0}])},className:"px-3 py-1 bg-primary-600 text-white rounded text-sm hover:bg-primary-700",children:"+ Add Item"})]}),s.jsx("div",{className:"space-y-3",children:j.map((e,t)=>s.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-6 gap-3",children:[(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("input",{type:"text",value:e.description,onChange:e=>k(t,"description",e.target.value),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",placeholder:"Item description"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Quantity"}),s.jsx("input",{type:"number",value:e.quantity,onChange:e=>k(t,"quantity",parseFloat(e.target.value)),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",min:"0",step:"0.01"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit Price"}),s.jsx("input",{type:"number",value:e.unitPrice,onChange:e=>k(t,"unitPrice",parseFloat(e.target.value)),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",min:"0",step:"0.01"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax %"}),s.jsx("input",{type:"number",value:e.tax,onChange:e=>k(t,"tax",parseFloat(e.target.value)),className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",min:"0",step:"0.01"})]}),s.jsx("div",{className:"flex items-end",children:j.length>1&&s.jsx("button",{type:"button",onClick:()=>w(t),className:"w-full px-2 py-1 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200",children:"Remove"})})]})},t))})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[s.jsx("span",{children:"Subtotal:"}),s.jsx("span",{className:"font-semibold",children:x(C.subtotal)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,s.jsxs)("span",{className:"text-gray-600",children:["Tax (",form.taxRate,"%)"]}),s.jsx("span",{className:"font-semibold",children:x(C.tax)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Discount"}),(0,s.jsxs)("span",{className:"font-semibold",children:["-",x(C.discount)]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center text-base pt-2 border-t border-gray-200 mt-2",children:[s.jsx("span",{className:"font-bold text-gray-900",children:"Total"}),s.jsx("span",{className:"text-green-600",children:x(C.total)})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms"}),s.jsx("textarea",{value:f.paymentTerms,onChange:e=>v({...f,paymentTerms:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:2})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Terms"}),s.jsx("textarea",{value:f.deliveryTerms,onChange:e=>v({...f,deliveryTerms:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:2})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("textarea",{value:f.notes,onChange:e=>v({...f,notes:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:3,placeholder:"Additional notes or terms"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>u.back(),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 flex items-center space-x-2",children:[h&&s.jsx(d.T,{size:"sm"}),s.jsx("span",{children:h?"Creating...":"Create Quotation"})]})]})]})]})}},95252:(e,t,r)=>{"use strict";r.d(t,{T:()=>a});var s=r(95344);function a({size:e="md",className:t=""}){return s.jsx("div",{className:`${{sm:"h-4 w-4 border-2",md:"h-8 w-8 border-2",lg:"h-12 w-12 border-3"}[e]} animate-spin rounded-full border-gray-300 border-t-primary-600 ${t}`,role:"status","aria-label":"Loading",children:s.jsx("span",{className:"sr-only",children:"Loading..."})})}},65489:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var s=r(67857);let a=()=>{let{user:e}=(0,s.a)();return{can:(t,r)=>{if(!e)return!1;if(e.roles?.some(e=>"admin"===e.toLowerCase()||"administrator"===e.toLowerCase()))return!0;if(!e.permissions)return!1;let s=e.permissions[t];if(!s)return!1;let a="none";switch(r){case"create":a=s.createLevel;break;case"read":a=s.readLevel;break;case"update":a=s.updateLevel;break;case"delete":a=s.deleteLevel}return"none"!==a&&void 0!==a},getScope:(t,r)=>{if(!e||!e.permissions||!e.permissions[t])return"none";if(e.roles?.some(e=>"admin"===e.toLowerCase()))return"all";let s=e.permissions[t],a="none";switch(r){case"create":a=s.createLevel;break;case"read":a=s.readLevel;break;case"update":a=s.updateLevel;break;case"delete":a=s.deleteLevel}return a},user:e}}},43989:(e,t,r)=>{"use strict";r.d(t,{p:()=>a});var s=r(92373);function a(){let{showToast:e}=(0,s.useToastContext)();return{success:t=>e("success",t),error:t=>e("error",t),warning:t=>e("warning",t),info:t=>e("info",t)}}},67857:(e,t,r)=>{"use strict";r.d(t,{I:()=>n,a:()=>i});var s=r(18117),a=r(3729);let n={register:async e=>{let t=await s.Z.post("/auth/register",e);return t.data.token&&(localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user))),t.data},login:async(e,t)=>{let r=await s.Z.post("/auth/login",{email:e,password:t});return r.data.token&&(localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user))),r.data},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},getToken:()=>null,getUser:()=>null,isAuthenticated:()=>!!n.getToken()},i=()=>{let[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{let e=n.getUser();if(e&&t(e),n.getToken())try{let e=await s.Z.get("/auth/profile");if(e.data.user){let r=e.data.user;localStorage.setItem("user",JSON.stringify(r)),t(r)}}catch(e){console.error("Auth refresh failed",e)}i(!1)})()},[]),{user:e,loading:r,isAuthenticated:!!e}}},22254:(e,t,r)=>{e.exports=r(14767)},27131:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>i});let s=(0,r(86843).createProxy)(String.raw`/Users/arun/Documents/applizor-softech-erp/frontend/app/(main)/quotations/create/page.tsx`),{__esModule:a,$$typeof:n}=s,i=s.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[6291,1934,3553],()=>r(71105));module.exports=s})();