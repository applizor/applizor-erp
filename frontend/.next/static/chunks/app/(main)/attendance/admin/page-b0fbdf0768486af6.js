(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2899],{62898:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let a=(0,s.forwardRef)(({color:a="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:d="",children:o,...x},u)=>(0,s.createElement)("svg",{ref:u,...n,width:l,height:l,stroke:a,strokeWidth:i?24*Number(c)/Number(l):c,className:["lucide",`lucide-${r(e)}`,d].join(" "),...x},[...t.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(o)?o:[o]]));return a.displayName=`${e}`,a}},81291:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62898).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},17158:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62898).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},35817:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62898).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},42482:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62898).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},65774:function(e,t,a){Promise.resolve().then(a.bind(a,82834))},82834:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var s=a(57437),n=a(2265),r=a(96165),l=a(10826),c=a(81291),i=a(17158),d=a(42482),o=a(35817);function x(){let[e,t]=(0,n.useState)([]),[a,x]=(0,n.useState)({}),[u,m]=(0,n.useState)([]),[h,p]=(0,n.useState)(!0),[y,g]=(0,n.useState)(new Date),[f,v]=(0,n.useState)(new Date().getMonth()),[w,b]=(0,n.useState)(new Date().getFullYear());(0,n.useEffect)(()=>{N()},[f,w]);let j=e=>{if("string"==typeof e)return e.split("T")[0];let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)},N=async()=>{try{p(!0);let e=new Date(w,f,1),a=new Date(w,f+1,0),[s,n,c,i]=await Promise.all([l.Z.get("/employees"),r.vm.getMusterRoll(f+1,w),r.N$.getRoster(j(e),j(a)),r.Nt.getAll(w)]);t(s.data),m(i);let d={};(n.matrix||[]).forEach(e=>{let t=e.employee.id;d[t]||(d[t]={}),Object.entries(e.attendance).forEach(e=>{let[a,s]=e,n=parseInt(a),r="".concat(w,"-").concat(String(f+1).padStart(2,"0"),"-").concat(String(n).padStart(2,"0"));d[t][r]={...s,source:"matrix"}})}),c.forEach(e=>{var t,a,s,n,r,l;let c=e.employeeId;d[c]||(d[c]={});let o=j(e.date),x=d[c][o];if(x&&x.status&&"absent"!==x.status&&"unknown"!==x.status){d[c][o]={...x,shiftName:null===(n=e.shift)||void 0===n?void 0:n.name,leaveType:null===(l=e.shift)||void 0===l?void 0:null===(r=l.name)||void 0===r?void 0:r.replace("Leave: ","")};return}let u=(null==x?void 0:x.status)||"absent";if(e.isLeave)u="on-leave";else if(null==x?void 0:x.checkIn){let t=new Date("".concat(o,"T").concat(e.shift.startTime)),a=new Date(x.checkIn);t.setMinutes(t.getMinutes()+15),u=a>t?"late":"present"}else if(i.find(e=>j(e.date)===o))u="holiday";else{let e=j(new Date);u=o>e?"":"absent"}!i.find(e=>j(e.date)===o)||e.isLeave||x&&x.checkIn||(u="holiday"),d[c][o]={...x,status:u,shiftName:null===(t=e.shift)||void 0===t?void 0:t.name,leaveType:null===(s=e.shift)||void 0===s?void 0:null===(a=s.name)||void 0===a?void 0:a.replace("Leave: ","")}}),x(d)}catch(e){console.error("Failed to load muster roll:",e)}finally{p(!1)}},Z=(()=>{let e=new Date(w,f,1),t=[];for(;e.getMonth()===f;)t.push(new Date(e)),e.setDate(e.getDate()+1);return t})(),k=e=>{switch(e){case"present":return(0,s.jsx)("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-green-100 text-green-700 text-xs font-bold",title:"Present",children:"P"});case"absent":return(0,s.jsx)("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-red-100 text-red-700 text-xs font-bold",title:"Absent",children:"A"});case"half-day":return(0,s.jsx)("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-yellow-100 text-yellow-700 text-xs font-bold",title:"Half Day",children:"HD"});case"late":return(0,s.jsx)("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-orange-100 text-orange-700 text-xs font-bold",title:"Late",children:"L"});case"on-leave":return(0,s.jsx)("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-blue-100 text-blue-700 text-xs font-bold",title:"On Leave",children:"OL"});case"holiday":return(0,s.jsx)("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-purple-100 text-purple-700 text-xs font-bold",title:"Holiday",children:"H"});default:return(0,s.jsx)("div",{className:"w-6 h-6 rounded flex items-center justify-center text-gray-300 text-xs font-bold",children:"-"})}};return(0,s.jsxs)("div",{className:"p-6 h-[calc(100vh-64px)] overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Register"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Monthly Muster Roll"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center bg-white rounded-md shadow-sm border border-gray-300",children:[(0,s.jsx)("button",{onClick:()=>{0===f?(v(11),b(w-1)):v(f-1)},className:"p-2 hover:bg-gray-50 border-r",children:(0,s.jsx)(c.Z,{size:20})}),(0,s.jsx)("div",{className:"px-4 py-2 font-medium min-w-[150px] text-center",children:new Date(w,f).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,s.jsx)("button",{onClick:()=>{11===f?(v(0),b(w+1)):v(f+1)},className:"p-2 hover:bg-gray-50 border-l",children:(0,s.jsx)(i.Z,{size:20})})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("button",{className:"flex items-center space-x-2 px-3 py-2 bg-white border border-gray-300 rounded-md hover:bg-gray-50 text-gray-700 text-sm",children:[(0,s.jsx)(d.Z,{size:16}),(0,s.jsx)("span",{children:"Filter"})]}),(0,s.jsxs)("button",{className:"flex items-center space-x-2 px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm shadow-sm",children:[(0,s.jsx)(o.Z,{size:16}),(0,s.jsx)("span",{children:"Export"})]})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 mb-4 px-1",children:[(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,s.jsx)("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold mr-2",children:"P"})," Present"]}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,s.jsx)("span",{className:"w-5 h-5 rounded bg-orange-100 text-orange-700 flex items-center justify-center font-bold mr-2",children:"L"})," Late"]}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,s.jsx)("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold mr-2",children:"A"})," Absent"]}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,s.jsx)("span",{className:"w-5 h-5 rounded bg-blue-100 text-blue-700 flex items-center justify-center font-bold mr-2",children:"OL"})," On Leave"]}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,s.jsx)("span",{className:"w-5 h-5 rounded bg-purple-100 text-purple-700 flex items-center justify-center font-bold mr-2",children:"H"})," Holiday"]}),(0,s.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,s.jsx)("span",{className:"w-5 h-5 rounded bg-yellow-100 text-yellow-700 flex items-center justify-center font-bold mr-2",children:"HD"})," Half Day"]})]}),(0,s.jsx)("div",{className:"bg-white shadow rounded-lg border flex-grow overflow-auto relative",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 border-separate border-spacing-0",children:[(0,s.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-20 shadow-sm",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-30 border-r w-64 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Employee"}),Z.map(e=>(0,s.jsx)("th",{className:"px-1 py-2 text-center text-xs font-semibold text-gray-500 uppercase min-w-[40px] border-b",children:(0,s.jsxs)("div",{className:"flex flex-col items-center ".concat([0,6].includes(e.getDay())?"text-red-500":""),children:[(0,s.jsx)("span",{children:e.getDate()}),(0,s.jsx)("span",{className:"text-[10px] opacity-75",children:e.toLocaleDateString("en-US",{weekday:"narrow"})})]})},e.toISOString())),(0,s.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider sticky right-0 bg-gray-50 z-30 border-l w-24",children:"Stats"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h?Array.from({length:10}).map((e,t)=>(0,s.jsxs)("tr",{className:"animate-pulse",children:[(0,s.jsx)("td",{className:"px-4 py-3 sticky left-0 bg-white border-r",children:(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32"})}),Array.from({length:30}).map((e,t)=>(0,s.jsx)("td",{className:"px-1 py-2",children:(0,s.jsx)("div",{className:"h-4 w-4 bg-gray-100 rounded mx-auto"})},t)),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-8 mx-auto"})})]},t)):e.map(e=>{let t=a[e.id]||{},n=Object.values(t).filter(e=>"present"===e.status||"late"===e.status).length;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap sticky left-0 bg-white z-10 border-r shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)]",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-bold text-xs",children:[e.firstName[0],e.lastName[0]]}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.firstName," ",e.lastName]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.employeeId})]})]})}),Z.map(e=>{let a=j(e),n=t[a],r=null==n?void 0:n.status;return!r&&u.find(e=>j(new Date(e.date))===a)&&(r="holiday"),(0,s.jsx)("td",{className:"px-1 py-2 text-center border-b border-gray-50",children:(0,s.jsx)("div",{className:"flex justify-center",children:k(r)})},a)}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap sticky right-0 bg-white z-10 border-l text-center",children:(0,s.jsxs)("span",{className:"text-xs font-bold text-gray-700 bg-gray-100 px-2 py-1 rounded-full",children:[n," Days"]})})]},e.id)})})]})})]})}},10826:function(e,t,a){"use strict";let s=a(54829).Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user")),Promise.reject(e)}),t.Z=s},96165:function(e,t,a){"use strict";a.d(t,{N$:function(){return i},NY:function(){return c},Nt:function(){return l},jU:function(){return r},vm:function(){return n}});var s=a(10826);let n={checkIn:async e=>(await s.Z.post("/attendance-leave/check-in",e)).data,checkOut:async()=>(await s.Z.post("/attendance-leave/check-out")).data,getMyAttendance:async(e,t)=>(await s.Z.get("/attendance-leave/my-attendance",{params:{month:e,year:t}})).data,todayStatus:async()=>(await s.Z.get("/attendance-leave/today-status")).data,getAll:async e=>(await s.Z.get("/attendance-leave/all-attendance",{params:e})).data,getMusterRoll:async(e,t,a)=>(await s.Z.get("/attendance-leave/all-attendance",{params:{month:e,year:t,departmentId:a}})).data},r={getTypes:async()=>(await s.Z.get("/attendance-leave/leave-types")).data,create:async e=>(await s.Z.post("/attendance-leave/leaves",e)).data,uploadAttachment:async e=>(await s.Z.post("/attendance-leave/leaves/upload",e,{headers:{"Content-Type":"multipart/form-data"}})).data,getMyLeaves:async()=>(await s.Z.get("/attendance-leave/my-leaves")).data,getAllLeaves:async e=>(await s.Z.get("/attendance-leave/all-leaves",{params:{status:e}})).data,updateStatus:async(e,t)=>(await s.Z.put("/attendance-leave/leaves/".concat(e,"/status"),{status:t})).data,calculateDays:async e=>(await s.Z.post("/attendance-leave/leaves/calculate",e)).data,getMyBalances:async()=>(await s.Z.get("/attendance-leave/my-balances")).data,getAllBalances:async e=>(await s.Z.get("/attendance-leave/all-balances",{params:e})).data},l={getAll:async e=>(await s.Z.get("/attendance-leave/holidays",{params:{year:e}})).data,create:async e=>(await s.Z.post("/attendance-leave/holidays",e)).data,delete:async e=>(await s.Z.delete("/attendance-leave/holidays/".concat(e))).data},c={getAll:async()=>(await s.Z.get("/attendance-leave/leave-types")).data,create:async e=>(await s.Z.post("/attendance-leave/leave-types",e)).data,update:async(e,t)=>(await s.Z.put("/attendance-leave/leave-types/".concat(e),t)).data,delete:async e=>(await s.Z.delete("/attendance-leave/leave-types/".concat(e))).data},i={getRoster:async(e,t,a)=>(await s.Z.get("/shift-rosters",{params:{startDate:e,endDate:t,departmentId:a}})).data,updateBatch:async e=>(await s.Z.post("/shift-rosters/batch",{assignments:e})).data}}},function(e){e.O(0,[4737,2971,4938,1744],function(){return e(e.s=65774)}),_N_E=e.O()}]);