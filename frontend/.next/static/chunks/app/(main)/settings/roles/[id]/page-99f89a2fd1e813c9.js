(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2908],{11961:function(e,t,r){Promise.resolve().then(r.bind(r,3029))},3029:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(57437),l=r(61153),a=r(2265),o=r(24033),n=r(10826);let i=[{label:"None",value:"none"},{label:"All",value:"all"},{label:"Added (My Entry)",value:"added"},{label:"Owned (Assigned)",value:"owned"},{label:"Added & Owned",value:"added_owned"}];function d(e){let{params:t}=e,r=(0,l.p)(),d=(0,o.useRouter)(),[c,u]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[p,v]=(0,a.useState)([]),[h,f]=(0,a.useState)({}),[g,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!0),[w,N]=(0,a.useState)("");(0,a.useEffect)(()=>{t.id&&(N(t.id),L(t.id))},[t.id]);let L=async e=>{try{let[t,r]=await Promise.all([n.Z.get("/roles/permissions"),n.Z.get("/roles/".concat(e))]),s=t.data.modules||[];v(s);let l={};s.forEach(e=>{l[e]={createLevel:"none",readLevel:"none",updateLevel:"none",deleteLevel:"none"}});let a=r.data;u(a.name),x(a.description||""),a.permissions&&Array.isArray(a.permissions)&&a.permissions.forEach(e=>{l[e.module]&&(l[e.module]={createLevel:e.createLevel,readLevel:e.readLevel,updateLevel:e.updateLevel,deleteLevel:e.deleteLevel})}),f(l)}catch(e){console.error("Failed to fetch data",e)}finally{j(!1)}},C=(e,t,r)=>{f(s=>({...s,[e]:{...s[e],[t]:r}}))},k=async e=>{e.preventDefault(),b(!0);try{let e=Object.keys(h).map(e=>({module:e,...h[e]}));await n.Z.put("/roles/".concat(w),{name:c,description:m,permissions:e}),d.push("/settings/roles")}catch(e){var t,s;console.error("Error updating role",e),r.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to update role")}finally{b(!1)}};return y?(0,s.jsx)("div",{className:"p-8",children:"Loading configuration..."}):(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold mb-6",children:["Edit Role: ",c]}),(0,s.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Role Name"}),(0,s.jsx)("input",{type:"text",required:!0,value:c,onChange:e=>u(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,s.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500"})]})]})}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Permission Matrix"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Default: None"})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Module"}),["createLevel","readLevel","updateLevel","deleteLevel"].map(e=>(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.replace("Level","")},e))]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 capitalize",children:e}),["createLevel","readLevel","updateLevel","deleteLevel"].map(t=>{var r;return(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,s.jsx)("select",{value:(null===(r=h[e])||void 0===r?void 0:r[t])||"none",onChange:r=>C(e,t,r.target.value),className:"block w-full max-w-[150px] rounded-md border-gray-300 py-1.5 text-base focus:border-primary-500 focus:outline-none focus:ring-primary-500 sm:text-sm",children:i.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})},t)})]},e))})]})})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>d.back(),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:g,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 disabled:opacity-50",children:"Update Role"})]})]})]})}},89456:function(e,t,r){"use strict";r.r(t),r.d(t,{ToastProvider:function(){return i},useToastContext:function(){return d}});var s=r(57437),l=r(2265);function a(e){let{id:t,type:r,message:a,onClose:o}=e;(0,l.useEffect)(()=>{let e=setTimeout(()=>o(t),5e3);return()=>clearTimeout(e)},[t,o]);let n={success:(0,s.jsx)("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),error:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),warning:(0,s.jsx)("svg",{className:"h-5 w-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),info:(0,s.jsx)("svg",{className:"h-5 w-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})};return(0,s.jsx)("div",{className:"".concat({success:"bg-green-50 border-green-500 text-green-800",error:"bg-red-50 border-red-500 text-red-800",warning:"bg-yellow-50 border-yellow-500 text-yellow-800",info:"bg-blue-50 border-blue-500 text-blue-800"}[r]," border-l-4 p-4 rounded-lg shadow-lg mb-2 animate-slide-in-right max-w-md"),children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:n[r]}),(0,s.jsx)("div",{className:"ml-3 flex-1",children:(0,s.jsx)("p",{className:"text-sm font-medium",children:a})}),(0,s.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,s.jsxs)("button",{onClick:()=>o(t),className:"inline-flex text-gray-400 hover:text-gray-600 focus:outline-none",children:[(0,s.jsx)("span",{className:"sr-only",children:"Close"}),(0,s.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})})}function o(e){let{toasts:t,onClose:r}=e;return(0,s.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(e=>(0,s.jsx)(a,{id:e.id,type:e.type,message:e.message,onClose:r},e.id))})}let n=(0,l.createContext)(void 0);function i(e){let{children:t}=e,[r,a]=(0,l.useState)([]),i=e=>{a(t=>t.filter(t=>t.id!==e))};return(0,s.jsxs)(n.Provider,{value:{toasts:r,showToast:(e,t)=>{let r=Date.now().toString()+Math.random().toString(36);a(s=>[...s,{id:r,type:e,message:t}])},removeToast:i},children:[t,(0,s.jsx)(o,{toasts:r,onClose:i})]})}function d(){let e=(0,l.useContext)(n);if(!e)throw Error("useToastContext must be used within ToastProvider");return e}},61153:function(e,t,r){"use strict";r.d(t,{p:function(){return l}});var s=r(89456);function l(){let{showToast:e}=(0,s.useToastContext)();return{success:t=>e("success",t),error:t=>e("error",t),warning:t=>e("warning",t),info:t=>e("info",t)}}},10826:function(e,t,r){"use strict";let s=r(54829).Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user")),Promise.reject(e)}),t.Z=s},24033:function(e,t,r){e.exports=r(15313)}},function(e){e.O(0,[4737,2971,4938,1744],function(){return e(e.s=11961)}),_N_E=e.O()}]);