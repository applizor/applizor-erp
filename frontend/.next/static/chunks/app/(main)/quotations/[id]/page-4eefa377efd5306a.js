(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6953],{62898:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:o="",children:d,...m},x)=>(0,a.createElement)("svg",{ref:x,...r,width:i,height:i,stroke:s,strokeWidth:c?24*Number(l)/Number(i):l,className:["lucide",`lucide-${n(e)}`,o].join(" "),...m},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(d)?d:[d]]));return s.displayName=`${e}`,s}},90998:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},73067:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},28203:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},13008:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6141:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},35817:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},99670:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},76637:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},28956:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},1295:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},49617:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},65958:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(62898).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},63231:function(e,t,s){Promise.resolve().then(s.bind(s,10412))},10412:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var a=s(57437),r=s(2265),n=s(24033),i=s(10826),l=s(61153),c=s(43206),o=s(7319),d=s(18559),m=s(73067),x=s(49617),u=s(62898);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,u.Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);var p=s(35817),y=s(76637),g=s(1295),v=s(13008),f=s(90998),b=s(61396),j=s.n(b),w=s(37902),N=s(99670),k=s(6141),Z=s(65958),S=s(28203);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let A=(0,u.Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),C=(0,u.Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var L=s(28956);function D(e){let{quotationId:t}=e,[s,n]=(0,r.useState)(null),[l,c]=(0,r.useState)(!0),[d,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{x()},[t]);let x=async()=>{try{c(!0);let e=await i.Z.get("/quotations/".concat(t,"/analytics"));n(e.data.analytics)}catch(e){console.error("Failed to load analytics:",e),m("Failed to load analytics data")}finally{c(!1)}};if(l)return(0,a.jsx)("div",{className:"p-8",children:(0,a.jsx)(o.T,{})});if(d)return(0,a.jsx)("div",{className:"p-4 text-red-500 bg-red-50 rounded-lg",children:d});if(!s)return null;let u=e=>{switch(e){case"VIEWED":return(0,a.jsx)(N.Z,{className:"w-4 h-4 text-blue-500"});case"EMAIL_OPENED":return(0,a.jsx)(g.Z,{className:"w-4 h-4 text-purple-500"});case"DOWNLOADED":return(0,a.jsx)(v.Z,{className:"w-4 h-4 text-green-500"});default:return(0,a.jsx)(f.Z,{className:"w-4 h-4 text-gray-500"})}},h=e=>{switch(e){case"VIEWED":return"Viewed Quotation";case"EMAIL_OPENED":return"Email Opened";case"DOWNLOADED":return"Downloaded PDF";default:return e.replace(/_/g," ")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Views"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:s.viewCount})]}),(0,a.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,a.jsx)(N.Z,{className:"w-6 h-6 text-blue-600"})})]}),s.lastViewedAt&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-4 flex items-center",children:[(0,a.jsx)(k.Z,{className:"w-3 h-3 mr-1"}),"Last viewed: ",new Date(s.lastViewedAt).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Current Status"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mt-2 capitalize",children:s.status})]}),(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat("accepted"===s.status?"bg-green-50":"rejected"===s.status?"bg-red-50":"viewed"===s.status?"bg-blue-50":"bg-gray-50"),children:"accepted"===s.status?(0,a.jsx)(v.Z,{className:"w-6 h-6 text-green-600"}):"rejected"===s.status?(0,a.jsx)(Z.Z,{className:"w-6 h-6 text-red-600"}):(0,a.jsx)(f.Z,{className:"w-6 h-6 text-gray-600"})})]}),s.clientAcceptedAt&&(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-4 flex items-center",children:[(0,a.jsx)(S.Z,{className:"w-3 h-3 mr-1"}),"Accepted on ",new Date(s.clientAcceptedAt).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Email Opens"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:s.emailOpens})]}),(0,a.jsx)("div",{className:"p-2 bg-purple-50 rounded-lg",children:(0,a.jsx)(g.Z,{className:"w-6 h-6 text-purple-600"})})]}),s.lastEmailOpenedAt?(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-4 flex items-center",children:[(0,a.jsx)(k.Z,{className:"w-3 h-3 mr-1"}),"Last opened: ",new Date(s.lastEmailOpenedAt).toLocaleString()]}):(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-4",children:"No email tracking data"})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Engagement"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:s.viewCount>0?"High":s.emailOpens>0?"Medium":"Low"})]}),(0,a.jsx)("div",{className:"p-2 bg-orange-50 rounded-lg",children:(0,a.jsx)(f.Z,{className:"w-6 h-6 text-orange-600"})})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Based on views & interactions"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Activity Log"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:0===s.activities.length?(0,a.jsx)("div",{className:"p-8 text-center text-gray-500",children:"No activity recorded yet."}):s.activities.map(e=>(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-gray-100 rounded-full",children:u(e.type)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:h(e.type)}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[e.deviceType&&(0,a.jsxs)("span",{className:"inline-flex items-center text-xs text-gray-500",children:["Mobile"===e.deviceType?(0,a.jsx)(A,{className:"w-3 h-3 mr-1"}):(0,a.jsx)(C,{className:"w-3 h-3 mr-1"}),e.deviceType]}),e.ipAddress&&(0,a.jsxs)("span",{className:"inline-flex items-center text-xs text-gray-500",children:[(0,a.jsx)(L.Z,{className:"w-3 h-3 mr-1"}),"::1"===e.ipAddress?"Localhost":e.ipAddress]})]})]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleString()})]})},e.id))})]})]})}function E(e){var t,s,u,b,N,k,Z,S,A,C;let{params:L}=e,E=(0,n.useRouter)(),T=(0,l.p)(),{can:I}=(0,c.g)(),{formatCurrency:q}=(0,d.U)(),[M,P]=(0,r.useState)(null),[z,O]=(0,r.useState)(!0),[R,F]=(0,r.useState)(!1),[U,Q]=(0,r.useState)(""),[V,B]=(0,r.useState)(!1),[H,_]=(0,r.useState)("details");(0,r.useEffect)(()=>{W()},[L.id]);let W=async()=>{try{O(!0);let e=await w.R.getById(L.id);P(e.quotation)}catch(e){T.error("Failed to load quotation details"),E.push("/quotations")}finally{O(!1)}},$=async()=>{try{F(!0);let e=(await i.Z.post("/quotations/".concat(L.id,"/generate-link"),{expiresInDays:30})).data.publicUrl;Q(e),B(!0),T.success("Public link generated successfully!"),await W()}catch(s){var e,t;T.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to generate link")}finally{F(!1)}},G=async()=>{if(confirm("Are you sure you want to revoke this public link? Clients will no longer be able to access it."))try{await i.Z.post("/quotations/".concat(L.id,"/revoke-link")),T.success("Public link revoked successfully"),await W()}catch(s){var e,t;T.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to revoke link")}};return z?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsx)(o.T,{size:"lg"})}):M?(0,a.jsxs)("div",{className:"p-6 max-w-5xl mx-auto print:p-0 print:max-w-none",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 print:hidden",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4 md:mb-0",children:[(0,a.jsx)("button",{onClick:()=>E.back(),className:"mr-4 p-2 hover:bg-gray-100 rounded-full transition",children:(0,a.jsx)(m.Z,{className:"w-5 h-5 text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:M.quotationNumber}),(0,a.jsx)("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ".concat("accepted"===M.status?"bg-green-100 text-green-800":"sent"===M.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:M.status})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:M.title})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[I("Quotation","update")&&"draft"===M.status&&(0,a.jsxs)(j(),{href:"/quotations/".concat(M.id,"/edit"),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),"Edit"]}),(0,a.jsxs)("button",{onClick:()=>{window.print()},className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:[(0,a.jsx)(h,{className:"w-4 h-4 mr-2"}),"Print"]}),I("Quotation","read")&&M.clientAcceptedAt&&(0,a.jsxs)("button",{onClick:async()=>{try{let e=await i.Z.get("/quotations/".concat(L.id,"/signed-pdf"),{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=t,s.setAttribute("download","Quotation-".concat(M.quotationNumber,"-Signed.pdf")),document.body.appendChild(s),s.click(),s.remove(),T.success("Signed PDF downloaded successfully")}catch(s){var e,t;T.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to download signed PDF")}},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Download Signed PDF"]}),I("Quotation","update")&&!M.isPublicEnabled&&(0,a.jsxs)("button",{onClick:$,disabled:R,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none disabled:opacity-50",children:[(0,a.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),R?"Generating...":"Generate Public Link"]}),I("Quotation","update")&&"draft"===M.status&&(0,a.jsxs)("button",{onClick:async()=>{try{F(!0),await i.Z.post("/quotations/".concat(L.id,"/send-email")),T.success("Quotation email sent successfully!"),await W()}catch(s){var e,t;T.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to send email")}finally{F(!1)}},disabled:R,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none disabled:opacity-50",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),R?"Sending...":"Send to Client"]}),I("Quotation","update")&&"accepted"===M.status&&!M.convertedToInvoiceId&&(0,a.jsxs)("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none",onClick:async()=>{if(confirm("Convert to Invoice?"))try{await w.R.convertToInvoice(M.id),T.success("Converted successfully"),E.push("/invoices")}catch(e){T.error("Conversion failed")}},children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Convert to Invoice"]})]})]}),(0,a.jsx)("div",{className:"border-b border-gray-200 mb-6 print:hidden",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>_("details"),className:"".concat("details"===H?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Details"}),I("Quotation","read")&&(0,a.jsxs)("button",{onClick:()=>_("analytics"),className:"".concat("analytics"===H?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center"),children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Analytics"]})]})}),"analytics"===H?(0,a.jsx)(D,{quotationId:L.id}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden border border-gray-100 print:shadow-none print:border-0",children:[(0,a.jsxs)("div",{className:"px-8 py-10 border-b border-gray-200 flex justify-between",children:[(0,a.jsxs)("div",{children:[(null===(t=M.company)||void 0===t?void 0:t.logo)?(0,a.jsx)("img",{src:M.company.logo.startsWith("http")?M.company.logo:"".concat("http://localhost:5000/api".replace("/api","")||"http://localhost:5000").concat(M.company.logo),alt:M.company.name,className:"h-12 w-auto mb-3"}):(0,a.jsx)("div",{className:"h-10 w-auto text-2xl font-bold text-primary-600 mb-2",children:(null===(s=M.company)||void 0===s?void 0:s.name)||"COMPANY NAME"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 max-w-xs",children:[(null===(u=M.company)||void 0===u?void 0:u.address)&&(0,a.jsxs)(a.Fragment,{children:[M.company.address,(0,a.jsx)("br",{})]}),(null===(b=M.company)||void 0===b?void 0:b.city)&&(null===(N=M.company)||void 0===N?void 0:N.state)&&(0,a.jsxs)(a.Fragment,{children:[M.company.city,", ",M.company.state," - ",M.company.pincode||"",(0,a.jsx)("br",{})]}),(null===(k=M.company)||void 0===k?void 0:k.country)&&(0,a.jsxs)(a.Fragment,{children:[M.company.country,(0,a.jsx)("br",{})]}),(null===(Z=M.company)||void 0===Z?void 0:Z.email)&&(0,a.jsx)(a.Fragment,{children:M.company.email}),(null===(S=M.company)||void 0===S?void 0:S.phone)&&(0,a.jsxs)(a.Fragment,{children:[" | ",M.company.phone]})]}),(null===(A=M.company)||void 0===A?void 0:A.gstin)&&(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-2",children:["GSTIN: ",M.company.gstin]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"QUOTATION"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Number:"})," ",M.quotationNumber]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,a.jsx)("span",{className:"font-medium",children:"Date:"})," ",new Date(M.quotationDate).toLocaleDateString()]}),M.validUntil&&(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,a.jsx)("span",{className:"font-medium",children:"Valid Until:"})," ",new Date(M.validUntil).toLocaleDateString()]})]})]}),(0,a.jsxs)("div",{className:"px-8 py-6 border-b border-gray-200",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Billed To"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:M.lead&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"font-medium text-base",children:M.lead.name}),M.lead.company&&(0,a.jsx)("p",{children:M.lead.company}),M.lead.email&&(0,a.jsx)("p",{children:M.lead.email}),M.lead.phone&&(0,a.jsx)("p",{children:M.lead.phone})]})})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:null===(C=M.items)||void 0===C?void 0:C.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.description}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:Number(e.quantity)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:q(e.unitPrice)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium text-right",children:q(Number(e.quantity)*Number(e.unitPrice))})]},t))}),(0,a.jsxs)("tfoot",{className:"bg-gray-50",children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{colSpan:3,className:"px-6 py-3 text-right text-sm font-medium text-gray-500",children:"Subtotal"}),(0,a.jsx)("td",{className:"px-6 py-3 text-right text-sm font-medium text-gray-900",children:q(M.subtotal)})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{colSpan:3,className:"px-6 py-3 text-right text-sm font-medium text-gray-500",children:"Tax"}),(0,a.jsx)("td",{className:"px-6 py-3 text-right text-sm font-medium text-gray-900",children:q(M.tax)})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{colSpan:3,className:"px-6 py-3 text-right text-sm font-medium text-gray-500",children:"Discount"}),(0,a.jsxs)("td",{className:"px-6 py-3 text-right text-sm font-medium text-gray-900",children:["-",q(M.discount)]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{colSpan:3,className:"px-6 py-3 text-right text-base font-bold text-gray-900",children:"Total"}),(0,a.jsx)("td",{className:"px-6 py-3 text-right text-base font-bold text-green-600",children:q(M.total)})]})]})]})}),M.notes&&(0,a.jsxs)("div",{className:"px-8 py-6 border-t border-gray-200 bg-gray-50",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Notes & Terms"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 whitespace-pre-wrap",children:M.notes})]})]}),M.isPublicEnabled&&M.publicToken&&(0,a.jsx)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-6 print:hidden",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Public Link Active"}),(0,a.jsxs)("p",{className:"text-sm text-blue-700 mb-3",children:["This quotation can be accessed via public link.",M.publicExpiresAt&&(0,a.jsxs)("span",{className:"block mt-1",children:["Expires: ",new Date(M.publicExpiresAt).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",readOnly:!0,value:"".concat(window.location.origin,"/public/quotations/").concat(M.publicToken),className:"flex-1 px-3 py-2 border border-blue-300 rounded-md text-sm bg-white"}),(0,a.jsx)("button",{onClick:()=>{if(null==M?void 0:M.publicToken){let e="".concat(window.location.origin,"/public/quotations/").concat(M.publicToken);navigator.clipboard.writeText(e),T.success("Link copied to clipboard!")}},className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700",children:"Copy Link"}),I("Quotation","update")&&(0,a.jsx)("button",{onClick:G,className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700",children:"Revoke"})]}),M.clientViewedAt&&(0,a.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:["Viewed by client: ",new Date(M.clientViewedAt).toLocaleString()]})]})})}),(M.clientAcceptedAt||M.clientRejectedAt)&&(0,a.jsxs)("div",{className:"mt-6 border rounded-lg p-6 print:hidden ".concat(M.clientAcceptedAt?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-1 ".concat(M.clientAcceptedAt?"text-green-900":"text-red-900"),children:M.clientAcceptedAt?"✓ Quotation Accepted":"✗ Quotation Declined"}),(0,a.jsx)("p",{className:"text-sm ".concat(M.clientAcceptedAt?"text-green-700":"text-red-700"),children:M.clientAcceptedAt?"Accepted on ".concat(new Date(M.clientAcceptedAt).toLocaleString()):"Declined on ".concat(new Date(M.clientRejectedAt).toLocaleString())})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Client Information"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[M.clientName&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Name:"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:M.clientName})]}),M.clientEmail&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Email:"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:M.clientEmail})]}),M.clientComments&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Comments:"}),(0,a.jsx)("p",{className:"mt-1 text-gray-600 whitespace-pre-wrap",children:M.clientComments})]})]})]}),M.clientAcceptedAt&&M.clientSignature&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Digital Signature"}),(0,a.jsx)("div",{className:"border-2 border-gray-300 rounded-lg bg-white p-4",children:(0,a.jsx)("img",{src:M.clientSignature,alt:"Client Signature",className:"max-w-full h-auto max-h-32"})}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Signed by ",M.clientName," on ",new Date(M.clientAcceptedAt).toLocaleDateString()]})]})]})]})]})]}):null}},7319:function(e,t,s){"use strict";s.d(t,{T:function(){return r}});var a=s(57437);function r(e){let{size:t="md",className:s=""}=e;return(0,a.jsx)("div",{className:"".concat({sm:"h-4 w-4 border-2",md:"h-8 w-8 border-2",lg:"h-12 w-12 border-3"}[t]," animate-spin rounded-full border-gray-300 border-t-primary-600 ").concat(s),role:"status","aria-label":"Loading",children:(0,a.jsx)("span",{className:"sr-only",children:"Loading..."})})}},18559:function(e,t,s){"use strict";s.d(t,{T:function(){return l},U:function(){return c}});var a=s(57437),r=s(2265),n=s(10826);let i=(0,r.createContext)(void 0),l=e=>{let{children:t}=e,[s,l]=(0,r.useState)("USD"),[c,o]=(0,r.useState)(!0),d=async()=>{try{if(localStorage.getItem("token")){var e,t;let s=await n.Z.get("/company");(null===(t=s.data)||void 0===t?void 0:null===(e=t.company)||void 0===e?void 0:e.currency)&&l(s.data.company.currency)}}catch(e){console.error("Failed to fetch currency settings",e)}finally{o(!1)}};(0,r.useEffect)(()=>{d()},[]);let m="INR"===s?"₹":"$";return(0,a.jsx)(i.Provider,{value:{currency:s,symbol:m,formatCurrency:e=>{if(null==e||""===e)return"".concat(m,"0.00");let t=Number(e);return isNaN(t)?"".concat(m,"0.00"):new Intl.NumberFormat("INR"===s?"en-IN":"en-US",{style:"currency",currency:s,minimumFractionDigits:2}).format(t)},refreshCurrency:d,loading:c},children:t})},c=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useCurrency must be used within a CurrencyProvider");return e}},89456:function(e,t,s){"use strict";s.r(t),s.d(t,{ToastProvider:function(){return c},useToastContext:function(){return o}});var a=s(57437),r=s(2265);function n(e){let{id:t,type:s,message:n,onClose:i}=e;(0,r.useEffect)(()=>{let e=setTimeout(()=>i(t),5e3);return()=>clearTimeout(e)},[t,i]);let l={success:(0,a.jsx)("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),error:(0,a.jsx)("svg",{className:"h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),warning:(0,a.jsx)("svg",{className:"h-5 w-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),info:(0,a.jsx)("svg",{className:"h-5 w-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})};return(0,a.jsx)("div",{className:"".concat({success:"bg-green-50 border-green-500 text-green-800",error:"bg-red-50 border-red-500 text-red-800",warning:"bg-yellow-50 border-yellow-500 text-yellow-800",info:"bg-blue-50 border-blue-500 text-blue-800"}[s]," border-l-4 p-4 rounded-lg shadow-lg mb-2 animate-slide-in-right max-w-md"),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:l[s]}),(0,a.jsx)("div",{className:"ml-3 flex-1",children:(0,a.jsx)("p",{className:"text-sm font-medium",children:n})}),(0,a.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,a.jsxs)("button",{onClick:()=>i(t),className:"inline-flex text-gray-400 hover:text-gray-600 focus:outline-none",children:[(0,a.jsx)("span",{className:"sr-only",children:"Close"}),(0,a.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})})}function i(e){let{toasts:t,onClose:s}=e;return(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(e=>(0,a.jsx)(n,{id:e.id,type:e.type,message:e.message,onClose:s},e.id))})}let l=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[s,n]=(0,r.useState)([]),c=e=>{n(t=>t.filter(t=>t.id!==e))};return(0,a.jsxs)(l.Provider,{value:{toasts:s,showToast:(e,t)=>{let s=Date.now().toString()+Math.random().toString(36);n(a=>[...a,{id:s,type:e,message:t}])},removeToast:c},children:[t,(0,a.jsx)(i,{toasts:s,onClose:c})]})}function o(){let e=(0,r.useContext)(l);if(!e)throw Error("useToastContext must be used within ToastProvider");return e}},43206:function(e,t,s){"use strict";s.d(t,{g:function(){return r}});var a=s(54175);let r=()=>{let{user:e}=(0,a.a)();return{can:(t,s)=>{var a;if(!e)return!1;if(null===(a=e.roles)||void 0===a?void 0:a.some(e=>"admin"===e.toLowerCase()||"administrator"===e.toLowerCase()))return!0;if(!e.permissions)return!1;let r=e.permissions[t];if(!r)return!1;let n="none";switch(s){case"create":n=r.createLevel;break;case"read":n=r.readLevel;break;case"update":n=r.updateLevel;break;case"delete":n=r.deleteLevel}return"none"!==n&&void 0!==n},getScope:(t,s)=>{var a;if(!e||!e.permissions||!e.permissions[t])return"none";if(null===(a=e.roles)||void 0===a?void 0:a.some(e=>"admin"===e.toLowerCase()))return"all";let r=e.permissions[t],n="none";switch(s){case"create":n=r.createLevel;break;case"read":n=r.readLevel;break;case"update":n=r.updateLevel;break;case"delete":n=r.deleteLevel}return n},user:e}}},61153:function(e,t,s){"use strict";s.d(t,{p:function(){return r}});var a=s(89456);function r(){let{showToast:e}=(0,a.useToastContext)();return{success:t=>e("success",t),error:t=>e("error",t),warning:t=>e("warning",t),info:t=>e("info",t)}}},10826:function(e,t,s){"use strict";let a=s(54829).Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user")),Promise.reject(e)}),t.Z=a},37902:function(e,t,s){"use strict";s.d(t,{R:function(){return r}});var a=s(10826);let r={getAll:async e=>(await a.Z.get("/quotations",{params:e})).data,getById:async e=>(await a.Z.get("/quotations/".concat(e))).data,create:async e=>(await a.Z.post("/quotations",e)).data,update:async(e,t)=>(await a.Z.put("/quotations/".concat(e),t)).data,delete:async e=>(await a.Z.delete("/quotations/".concat(e))).data,convertToInvoice:async e=>(await a.Z.post("/quotations/".concat(e,"/convert-to-invoice"))).data}},54175:function(e,t,s){"use strict";s.d(t,{I:function(){return n},a:function(){return i}});var a=s(10826),r=s(2265);let n={register:async e=>{let t=await a.Z.post("/auth/register",e);return t.data.token&&(localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user))),t.data},login:async(e,t)=>{let s=await a.Z.post("/auth/login",{email:e,password:t});return s.data.token&&(localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user))),s.data},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},getToken:()=>localStorage.getItem("token"),getUser:()=>{let e=localStorage.getItem("user");return e?JSON.parse(e):null},isAuthenticated:()=>!!n.getToken()},i=()=>{let[e,t]=(0,r.useState)(null),[s,i]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{let e=n.getUser();if(e&&t(e),n.getToken())try{let e=await a.Z.get("/auth/profile");if(e.data.user){let s=e.data.user;localStorage.setItem("user",JSON.stringify(s)),t(s)}}catch(e){console.error("Auth refresh failed",e)}i(!1)})()},[]),{user:e,loading:s,isAuthenticated:!!e}}},24033:function(e,t,s){e.exports=s(15313)}},function(e){e.O(0,[4737,1396,2971,4938,1744],function(){return e(e.s=63231)}),_N_E=e.O()}]);